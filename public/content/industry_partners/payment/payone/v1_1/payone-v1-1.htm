<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-conditions="Spryker.B2C,Spryker.DemoShop" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Industry Partners|Payment">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="msapplication-config" content="../../../../../Skins/Favicons/browserconfig.xml" />
        <link rel="apple-touch-icon" sizes="180x180" href="../../../../../Skins/Favicons/apple-touch-icon.png" />
        <link rel="shortcut icon" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="96x96" href="../../../../../Skins/Favicons/favicon-96x96.png" />
        <link rel="icon" sizes="32x32" href="../../../../../Skins/Favicons/favicon-32x32.png" />
        <link rel="icon" sizes="16x16" href="../../../../../Skins/Favicons/favicon-16x16.png" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Payment Integration - BS Payone - 1.1</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" />
        <link href="../../../../resources/stylesheets/perfect-scrollbar.css" rel="stylesheet" />
        <link href="../../../../resources/stylesheets/prism.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../resources/stylesheets/mainstyles.css" rel="stylesheet" />
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="small" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../../../../home.htm" alt="Logo"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search the Academy" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container" data-mc-content-body="True">
                                <div class="search-container">
                                    <form class="search" action="#">
                                        <div class="search-bar search-bar-container needs-pie _Skins_SearchTopics mc-component">
                                            <input class="search-field needs-pie" type="search" placeholder="Search" />
                                            <div class="search-filter-wrapper">
                                                <div class="search-filter">
                                                    <div class="search-filter-content">
                                                        <ul>
                                                            <li>All Files</li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="search-submit-wrapper" dir="ltr">
                                                <div class="search-submit" title="Search">
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="row collapse">
                                    <div class="top-bar">
                                        <div class="breadcrumbs-block">
                                            <div class="nocontent">
                                                <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="topic-layout">
                                        <div>
                                            <div class="side-menu">
                                                <div data-sticky-container="" id="VvWi87JwH0m9yM8w7KRejA">
                                                    <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="VvWi87JwH0m9yM8w7KRejA:top" data-bottom-anchor="contentBody:bottom" data-sticky-on="small" data-scroll-container-on="small">
                                                        <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/master.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="side-menu">
                                                <div class="toolbar-wrapper">
                                                    <div class="widget-github js-widget-github"><a class="widget-github-link js-widget-github-link" href="https://github.com/spryker/spryker-documentation" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26"><path d="M13.5 0C6.057 0 0 6.057 0 13.5c0 5.888 3.791 10.905 9.058 12.745a.463.463 0 0 0 .258.088c1.316.43 2.724.667 4.184.667C20.943 27 27 20.943 27 13.5S20.943 0 13.5 0zm0 .931c6.93 0 12.569 5.639 12.569 12.569 0 5.428-3.459 10.061-8.287 11.818a1.903 1.903 0 0 1-.092-.527v-2.446c0-.975-.477-2.037-.946-2.75 2.584-.436 5.537-1.776 5.537-6.779 0-1.37-.429-2.58-1.275-3.598.186-.611.415-1.9-.225-3.52a.47.47 0 0 0-.291-.272c-.13-.04-1.326-.35-3.806 1.277a12.921 12.921 0 0 0-6.36 0c-2.481-1.63-3.68-1.319-3.809-1.277a.47.47 0 0 0-.29.273C5.582 7.319 5.811 8.607 6 9.218c-.85 1.018-1.279 2.227-1.279 3.598 0 4.957 2.9 6.323 5.463 6.778-.322.407-.66.934-.81 1.47-.661.184-2.018.19-2.929-1.37-.032-.06-.829-1.475-2.4-1.584-.25.002-.882.042-1.035.525-.169.537.424.944.679 1.117l.058.034c.029.015.707.371 1.213 1.644.105.333 1.03 2.84 4.353 2.399.002.367 0 .552-.004.7v.26c0 .15-.045.378-.096.525C4.386 23.558.931 18.924.931 13.5.931 6.57 6.57.931 13.5.931zm6.51 5.375c.5 1.471.158 2.537.035 2.839a.468.468 0 0 0 .089.49c.805.883 1.214 1.952 1.214 3.181 0 4.72-2.796 5.666-5.535 5.97a.464.464 0 0 0-.253.815c.368.314 1.199 1.68 1.199 2.744v2.446c0 .009.001.414.134.809a12.513 12.513 0 0 1-6.792-.002c.135-.396.139-.802.139-.81l.001-.248c.002-.211.006-.497 0-1.266a.473.473 0 0 0-.174-.362.47.47 0 0 0-.391-.09c-3.126.681-3.802-1.576-3.828-1.67l-.016-.047c-.448-1.135-1.037-1.713-1.388-1.975.759.267 1.182 1.007 1.193 1.024 1.231 2.107 3.264 2.162 4.328 1.685a.463.463 0 0 0 .27-.36c.095-.665.826-1.545 1.196-1.87a.464.464 0 0 0 .136-.488.461.461 0 0 0-.39-.324c-2.73-.31-5.524-1.266-5.524-5.98 0-1.228.41-2.3 1.219-3.181a.464.464 0 0 0 .087-.491c-.124-.302-.467-1.364.031-2.837.396.013 1.362.182 2.988 1.286.112.076.256.1.387.063.973-.27 2.058-.416 3.135-.421 1.08.005 2.166.15 3.14.421.131.037.273.013.386-.063 1.635-1.11 2.6-1.275 2.984-1.288z" /></svg></a>
                                                    </div>
                                                    <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolbar mc-component nocontent" style="mc-topic-toolbar-items: PreviousTopic NextTopic Print ExpandAll CollapseAll;">
                                                        <div class="button-group-container-left">
                                                            <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                                <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                            </button>
                                                            <button class="button needs-pie next-topic-button" title="Navigate next">
                                                                <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                            </button>
                                                            <button class="button needs-pie print-button" title="Print">
                                                                <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                            </button>
                                                            <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                                <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="js-anchorer">
                                                    <h1>Payment Integration - BS Payone - 1.1</h1>
                                                    <p><a href="javascript:void(0);" class="MCHelpControl MCHelpControl-Related relatedTopics" data-mc-topics="Payment Integration - BS PayOne - 1.0|../v1_0/payone-v1-0.htm" target="_blank" style="mc-label: 'Versions';"><span class="MCHelpControl-RelatedHotSpot_"><img class="MCHelpControl_Image_Icon" src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="16" width="16" alt="Related Topics Link Icon" />Versions</span></a>
                                                    </p>
                                                    <p>
                                                        <img src="../../../../resources/images/payone/payone-logo_419x81.png" style="width: 419;height: 81;" />
                                                    </p>
                                                    <h2>Partner Information</h2>
                                                    <table style="margin-left: 0; margin-right: auto;">
                                                        <col />
                                                        <col />
                                                        <tbody>
                                                            <tr>
                                                                <td><a href="https://www.payone.com/" target="_blank">ABOUT BS PAYONE</a>
                                                                </td>
                                                                <td>&#160;</td>
                                                            </tr>
                                                            <tr>
                                                                <td colspan="2">
                                                                    <p>BS PAYONE GmbH is headquartered in Frankfurt am Main and is one of the leading omnichannel-payment providers in Europe. In addition to providing customer support to numerous Savings Banks (Sparkasse) the full-service payment service provider also provides cashless payment transaction services to more than 255,000 customers from stationary trade to the automated and holistic processing of e-commerce and mobile payments.</p>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td>YOUR ADVANTAGES:<![CDATA[					]]></td>
                                                                <td>&#160;</td>
                                                            </tr>
                                                            <tr>
                                                                <td colspan="2">
                                                                    <ul>
                                                                        <li value="1"><b>One solution, one partner, one contract</b> <p>Simple &amp; efficient. Technical processing and financial services from a single source.</p></li>
                                                                        <li value="2"><b>International payment processing</b> <p>Access to international and local payment methods.</p></li>
                                                                        <li value="3"><b>Automatic debtor management</b> <p>Effective accounting support through transaction allocation and reconciliation.</p></li>
                                                                        <li value="4"><b>Credit entries independent of payment type </b>
                                                                            <p>Fast returns management. With automated refunds.</p>
                                                                        </li>
                                                                        <li value="5"><b>Short time to market thanks to plug’n pay </b>
                                                                            <p>1-click checkout and seamless integration. For an increasing conversion rate.</p>
                                                                        </li>
                                                                    </ul>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <hr width="100%" size="0" align="center" />
                                                    <p>We integrate with a wide range of payment methods that can be configured according to your needs and convenience. Payment method flows are configured using state machines.

</p>
                                                    <p>Payone provides seven main methods of payment:

</p>
                                                    <ul>
                                                        <li class="bullet_list" value="1"><a href="../v1_0/payone-credit-card.htm">Credit Card</a>
                                                        </li>
                                                        <li class="bullet_list" value="2"><a href="../v1_0/payone-direct-debit.htm">Direct Debit</a>
                                                        </li>
                                                        <li class="bullet_list" value="3"><a href="../v1_0/payone-online-trans.htm">Online Transfer</a>
                                                        </li>
                                                        <li class="bullet_list" value="4"><a href="../v1_0/payone-paypal.htm">Paypal
</a>
                                                        </li>
                                                        <li class="bullet_list" value="5"><a href="../v1_0/payone-prepayment.htm">Prepayment</a>
                                                        </li>
                                                        <li class="bullet_list" value="6"><a href="../v1_0/payone-invoice.htm">Invoice</a>
                                                        </li>
                                                        <li class="bullet_list" value="7"><a href="payone-integration-security-invoice.htm">Security Invoice
</a>
                                                        </li>
                                                        <li class="bullet_list" value="8"><a href="payone-paypal-express-checkout.htm">Paypal Express Checkout</a>
                                                        </li>
                                                    </ul>
                                                    <p>We use state machines for handling and managing orders and payments. To integrate Payone payments, a state machine for Payone should be created.

</p>
                                                    <p>A basic and fully functional state machine for each payment method is already built:

</p>
                                                    <ul>
                                                        <li class="bullet_list" value="1"><var>PayoneCreditCard.xml</var><![CDATA[
        ]]></li>
                                                        <li class="bullet_list" value="2"><var>PayoneDirectDebit.xml</var><![CDATA[
        ]]></li>
                                                        <li class="bullet_list" value="3"><var>PayoneEWallet.xml
    </var>
                                                        </li>
                                                        <li class="bullet_list" value="4"><var>PayoneInvoice.xml</var><![CDATA[
        ]]></li>
                                                        <li class="bullet_list" value="5"><var>PayoneSecurityInvoice.xml</var><![CDATA[
			]]></li>
                                                        <li class="bullet_list" value="6"><var>PayoneOnlineTransfer.xml</var>
                                                        </li>
                                                        <li class="bullet_list" value="7"><var>PayonePrePayment.xml</var><![CDATA[
        ]]></li>
                                                        <li class="bullet_list" value="8"><var>PayonePaypalExpressCheckout.xml</var>
                                                        </li>
                                                    </ul>
                                                    <p>You can use the same state machines or build new ones. The state machine commands and conditions trigger Payone facade calls in order to perform the needed requests to Payone API.

</p>
                                                    <h3>Integration to Your Project
</h3>
                                                    <p>You can copy over configs to your config from the Payone module’s <var>config.dist.php</var> file.

</p>
                                                    <p>The configuration to integrate payments using Payone is:

</p>
                                                    <ul>
                                                        <li class="bullet_list" value="1"><var>PAYONE_CREDENTIALS_KEY</var>: payment portal key (required).
    </li>
                                                        <li class="bullet_list" value="2"><var>PAYONE_CREDENTIALS_MID</var>: merchant id (required).
    </li>
                                                        <li class="bullet_list" value="3"><var>PAYONE_CREDENTIALS_AID</var>: sub-account id (required).
    </li>
                                                        <li class="bullet_list" value="4"><var>PAYONE_CREDENTIALS_PORTAL_ID</var>: payment portal id (required).
    </li>
                                                        <li class="bullet_list" value="5"><var>PAYONE_MODE</var>: the mode of the transaction, either test or live (required).
    </li>
                                                        <li class="bullet_list" value="6"><var>PAYONE_BUSINESS_RELATION</var>: the business relation of the transaction, b2b or b2c (required).
    </li>
                                                        <li class="bullet_list" value="7"><var>PAYONE_PAYMENT_GATEWAY_URL</var>: server-API-URL.
    </li>
                                                        <li class="bullet_list" value="8"><var>PAYONE_REDIRECT_SUCCESS_URL</var>: return URL for successful result on redirect.
    </li>
                                                        <li class="bullet_list" value="9"><var>PAYONE_REDIRECT_ERROR_URL</var>: return URL for error on redirect.
    </li>
                                                        <li class="bullet_list" value="10"><var>PAYONE_REDIRECT_BACK_URL</var>: return URL that will be engaged when user cancels action on redirect.
    </li>
                                                        <li class="bullet_list" value="11"><var>PAYONE_EMPTY_SEQUENCE_NUMBER</var>: sequence number that will be used in API requests when ommitted (0 by default).
    </li>
                                                        <li class="bullet_list" value="12"><var>PAYONE_CREDENTIALS_ENCODING</var>: encoding of data sent in requests to Payone API (‘UTF-8’ for the <span class="GeneralProductName">Spryker Commerce OS</span> module).
    </li>
                                                        <li class="bullet_list" value="13"><var>HOST_YVES</var>: yves host in order to generate urls inside payone module.
    </li>
                                                        <li class="bullet_list" value="14"><var>PAYONE_STANDARD_CHECKOUT_ENTRY_POINT_URL</var>: entry point url to standart checkout in project(or middleware url in project, depending on your implementation).
    </li>
                                                        <li class="bullet_list" value="15"><var>PAYONE_EXPRESS_CHECKOUT_BACK_URL</var>: if user presses back button(if so exists) on payone side, this urs is used to redirect user back to shop.
    </li>
                                                        <li class="bullet_list" value="16"><var>PAYONE_EXPRESS_CHECKOUT_FAILURE_URL</var>: if something goes wrong when the user is on payone side, redirect here is done.
    </li>
                                                    </ul>
                                                    <h3>Integration with Checkout module (CheckoutDependencyProvider):</h3>
                                                    <p>
    Project (demoshop) level <var>\Pyz\Yves\Checkout\CheckoutDependencyProvider</var> method <var>provideDependencies</var> container has to be extended with the static::PAYMENT_SUB_FORMS
    and static::PAYMENT_METHOD_HANDLER keys which have to contain information about PSP payment methods SubForms and SubForms Handlers accordingly.
</p>
                                                    <p>Add the keys to <var>\Pyz\Yves\Checkout\CheckoutDependencyProvider::provideDependencies</var>:</p><pre><code class="bash">&lt;?php
$container[static::PAYMENT_METHOD_HANDLER] = function () {
            $paymentMethodHandler = new StepHandlerPluginCollection();

            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_INVOICE);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_SECURITY_INVOICE);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_CREDIT_CARD);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_DIRECT_DEBIT);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_E_WALLET);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_ONLINE_TRANSFER);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_PRE_PAYMENT);
            $paymentMethodHandler-&gt;add(new PayoneHandlerPlugin(), PaymentTransfer::PAYONE_PAYPAL_EXPRESS_CHECKOUT);

            return $paymentMethodHandler;
        };

        $container[static::PAYMENT_SUB_FORMS] = function () {
            $paymentSubFormPlugin = new SubFormPluginCollection();

            $paymentSubFormPlugin-&gt;add(new PayoneInvoiceSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayoneSecurityInvoiceSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayoneCreditCardSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayoneDirectDebitSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayoneEWalletSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayoneEpsOnlineTransferSubFormPlugin());
            $paymentSubFormPlugin-&gt;add(new PayonePrePaymentSubFormPlugin());

            return $paymentSubFormPlugin;
        };
</code></pre>
                                                    <h3>Integration with Payment module (PaymentDependencyProvider):</h3>
                                                    <p>
    Project (demoshop) level <var>\Pyz\Zed\Payment\PaymentDependencyProvider</var> method <var>provideBusinessLayerDependencies</var> container
    has to be extended with the static::CHECKOUT_PLUGINS key which has to contain information about PSP payment pre-, post-, and -save Order plugins.
</p>
                                                    <p>Add the key to <var>\Pyz\Zed\Payment\PaymentDependencyProvider</var>:</p><pre><code class="bash">&lt;?php
$container-&gt;extend(static::CHECKOUT_PLUGINS, function (CheckoutPluginCollection $pluginCollection) {
            $pluginCollection-&gt;add(new PayonePreCheckPlugin(), PayoneConfig::PROVIDER_NAME, static::CHECKOUT_PRE_CHECK_PLUGINS);
            $pluginCollection-&gt;add(new PayoneSaveOrderPlugin(), PayoneConfig::PROVIDER_NAME, static::CHECKOUT_ORDER_SAVER_PLUGINS);
            $pluginCollection-&gt;add(new PayonePostSaveHookPlugin(), PayoneConfig::PROVIDER_NAME, static::CHECKOUT_POST_SAVE_PLUGINS);

            return $pluginCollection;
        });
</code></pre>
                                                    <h3>Integration with OMS module (OmsDependencyProvider)</h3>
                                                    <p>
    Project (demoshop) level <var>\Pyz\Zed\Oms\OmsDependencyProvider</var> method <var>provideBusinessLayerDependencies</var> container has to be extended with the static::CONDITION_PLUGINS
    and static::COMMAND_PLUGINS keys which have to contain information about PSP OMS State Machine conditions and commands plugins.
</p>
                                                    <p>Add the keys to <var>\Pyz\Zed\Oms\OmsDependencyProvider</var>:</p><pre><code class="bash">&lt;?php
$container-&gt;extend(static::CONDITION_PLUGINS, function (ConditionCollectionInterface $conditionCollection) {
            $conditionCollection-&gt;add(new PreAuthorizationIsApprovedConditionPlugin(), 'Payone/PreAuthorizationIsApproved');
            $conditionCollection-&gt;add(new AuthorizationIsApprovedConditionPlugin(), 'Payone/AuthorizationIsApproved');
            $conditionCollection-&gt;add(new CaptureIsApprovedConditionPlugin(), 'Payone/CaptureIsApproved');
            $conditionCollection-&gt;add(new RefundIsApprovedConditionPlugin(), 'Payone/RefundIsApproved');
            $conditionCollection-&gt;add(new RefundIsPossibleConditionPlugin(), 'Payone/RefundIsPossible');
            $conditionCollection-&gt;add(new PreAuthorizationIsErrorConditionPlugin(), 'Payone/PreAuthorizationIsError');
            $conditionCollection-&gt;add(new AuthorizationIsErrorConditionPlugin(), 'Payone/AuthorizationIsError');
            $conditionCollection-&gt;add(new PreAuthorizationIsRedirectConditionPlugin(), 'Payone/PreAuthorizationIsRedirect');
            $conditionCollection-&gt;add(new AuthorizationIsRedirectConditionPlugin(), 'Payone/AuthorizationIsRedirect');
            $conditionCollection-&gt;add(new PaymentIsAppointedConditionPlugin(), 'Payone/PaymentIsAppointed');
            $conditionCollection-&gt;add(new PaymentIsCaptureConditionPlugin(), 'Payone/PaymentIsCapture');
            $conditionCollection-&gt;add(new PaymentIsPaidConditionPlugin(), 'Payone/PaymentIsPaid');
            $conditionCollection-&gt;add(new PaymentIsUnderPaidConditionPlugin(), 'Payone/PaymentIsUnderPaid');
            $conditionCollection-&gt;add(new PaymentIsOverpaidConditionPlugin(), 'Payone/PaymentIsOverpaid');
            $conditionCollection-&gt;add(new PaymentIsRefundConditionPlugin(), 'Payone/PaymentIsRefund');

            return $conditionCollection;
        });

        $container-&gt;extend(static::COMMAND_PLUGINS, function (CommandCollectionInterface $commandCollection) {
            $commandCollection-&gt;add(new PreAuthorizeCommandPlugin(), 'Payone/PreAuthorize');
            $commandCollection-&gt;add(new AuthorizeCommandPlugin(), 'Payone/Authorize');
            $commandCollection-&gt;add(new CancelCommandPlugin(), 'Payone/Cancel');
            $commandCollection-&gt;add(new CaptureCommandPlugin(), 'Payone/Capture');
            $commandCollection-&gt;add(new CaptureWithSettlementCommandPlugin(), 'Payone/CaptureWithSettlement');
            $commandCollection-&gt;add(new RefundCommandPlugin(), 'Payone/Refund');

            return $commandCollection;
        });
</code></pre>
                                                    <p>In order to use the state machines provided by Payone module, make sure to add the location path to configuration:
</p><pre><code class="bash">&lt;?php
$config[OmsConstants::PROCESS_LOCATION] = [
    OmsConfig::DEFAULT_PROCESS_LOCATION,
    $config[KernelConstants::SPRYKER_ROOT] . '/payone/config/Zed/Oms'
];
</code></pre>
                                                    <p>Add Payone controller provider to Yves bootstrap (this is required to provide endpoint URL for transaction status callbacks) in <var>src/Pyz/Yves/Application/YvesBootstrap.php
</var>.</p><pre><code class="bash">&lt;?php
use Spryker\Yves\Payone\Plugin\Provider\PayoneControllerProvider;
    …
    protected function registerControllerProviders()
    {
        …
        $controllerProviders = [
            …
            new PayoneControllerProvider($ssl),
        ];
</code></pre>
                                                    <p>Optionally configure security firewall for <var>/payone</var> route to accept <var>TransactionStatus</var> requests.

</p>
                                                    <p class="info">Excerpt from PAYONE Platform Channel Server API document:

    <br />According to the configuration of your payment portal you will receive the data and the status for each payment processed via the URL you have submitted. The data transfer is based on simple HTTP-POST request (key/value pairs). The TransactionStatus is sent from the following IP addresses: 185.60.20.0/24 (i.e. 185.60.20.1 to 185.60.20.254). Please configure your firewall to allow incoming packets from these IP addresses.
</p>
                                                    <p>To provide payment details for rendering on frontend, add Payone client to the Checkout and to the Customer module:

</p>
                                                    <p>in <var>src/&lt;project_name&gt;/Yves/Checkout/CheckoutDependencyProvider.php</var><![CDATA[
    ]]></p><pre><code class="bash">&lt;?php
...
class CheckoutDependencyProvider extends SprykerCheckoutDependencyProvider
{
    ...
    const CLIENT_PAYONE = 'CLIENT_PAYONE';
    ...
    protected function provideClients(Container $container)
    {
        ...
        $container[static::CLIENT_PAYONE] = function (Container $container) {
            return $container-&gt;getLocator()-&gt;payone()-&gt;client();
        };
        ...
        return $container;
    }
</code></pre>
                                                    <p>in <var>src//Yves/Customer/CustomerDependencyProvider.php`</var><![CDATA[
    ]]></p><pre><code class="bash">&lt;?php
...
class CheckoutDependencyProvider extends SprykerCheckoutDependencyProvider
{
    ...
    const CLIENT_PAYONE = 'CLIENT_PAYONE';
    ...
    protected function provideClients(Container $container)
    {
        ...
        $container[static::CLIENT_PAYONE] = function (Container $container) {
            return $container-&gt;getLocator()-&gt;payone()-&gt;client();
        };
        ...
        return $container;
    }</code></pre>
                                                    <p>To add payment details on success step of checkout:

</p>
                                                    <p>Add quote and payment details to template variables in <var>src/&lt;project_name&gt;/Yves/Checkout/Process/Steps/SuccessStep.php
</var></p>
                                                    <div class="MCDropDown MCDropDown_Open dropDown"><span class="MCDropDownHead dropDownHead"><a href="javascript:void(0);" class="MCDropDownHotSpot dropDownHotspot MCDropDownHotSpot_ MCHotSpotImage"><img class="MCDropDown_Image_Icon" src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" height="11" width="16" alt="Closed" data-mc-alt2="Open" />Click to expand the code sample</a></span>
                                                        <div class="MCDropDownBody dropDownBody"><pre xml:space="preserve"><code class="bash">&lt;?php
...
use Generated\Shared\Transfer\PayoneGetPaymentDetailTransfer;
use Spryker\Client\Payone\PayoneClientInterface;
use Spryker\Yves\Payone\Handler\PayoneHandler;
...
class SuccessStep extends AbstractBaseStep
{
    ...
    /**
     * @var \Spryker\Client\Payone\PayoneClientInterface
     */
    protected $payoneClient;

    /**
     * @var \Generated\Shared\Transfer\QuoteTransfer
     */
    protected $quoteTransfer;
    ...
    public function __construct(CustomerClientInterface $customerClient, PayoneClientInterface $payoneClient, $stepRoute, $escapeRoute)
    {
        ...
        $this-&gt;payoneClient = $payoneClient;
    }
    ...
    public function execute(Request $request, AbstractTransfer $quoteTransfer)
    {
        $this-&gt;customerClient-&gt;markCustomerAsDirty();

        if (method_exists($quoteTransfer-&gt;getPayment(), 'getPayone')) {
            $this-&gt;quoteTransfer = $quoteTransfer;
        }

        return new QuoteTransfer();
    }
    ...
    /**
     * @param \Spryker\Shared\Kernel\AbstractTransfer $dataTransfer
     *
     * @return array
     */
    public function getTemplateVariables(AbstractTransfer $dataTransfer)
    {
        $getPaymentDetailTransfer = new PayoneGetPaymentDetailTransfer();
        if ($this-&gt;quoteTransfer-&gt;getPayment()-&gt;getPaymentProvider() === PayoneHandler::PAYMENT_PROVIDER) {
            $getPaymentDetailTransfer-&gt;setOrderReference($this-&gt;quoteTransfer-&gt;getOrderReference());
            $getPaymentDetailTransfer = $this-&gt;payoneClient-&gt;getPaymentDetail($getPaymentDetailTransfer);
        }
        return [
            'quoteTransfer' =&gt; $this-&gt;quoteTransfer,
            'paymentDetail' =&gt; $getPaymentDetailTransfer-&gt;getPaymentDetail(),
        ];
    }
</code></pre>
                                                        </div>
                                                    </div>
                                                    <p>Inject Payone client into the step factory <var>src/&lt;project_name&gt;/Yves/Checkout/Process/StepFactory.php
</var></p><pre><code class="bash">&lt;?php
...
protected function createSuccessStep()
{
    return new SuccessStep(
        $this-&gt;getProvidedDependency(CheckoutDependencyProvider::CLIENT_CUSTOMER),
        $this-&gt;getProvidedDependency(CheckoutDependencyProvider::CLIENT_PAYONE),
        CheckoutControllerProvider::CHECKOUT_SUCCESS,
        ApplicationControllerProvider::ROUTE_HOME
    );
}
</code></pre>
                                                    <p>To add payment details on order details page in customer cabinet:

</p>
                                                    <p>Add method that will create the Payone client into the CustomerFactory <var>src/&lt;project_name&gt;/Yves/Customer/CustomerFactory.php</var>:
</p><pre><code class="bash">&lt;?php
...
class CustomerFactory extends AbstractFactory
{
    ...
    /**
     * @return \Spryker\Client\Payone\PayoneClientInterface
     */
    public function createPayoneClient()
    {
        return $this-&gt;getProvidedDependency(CustomerDependencyProvider::CLIENT_PAYONE);
    }
</code></pre>
                                                    <p>Add payment details to template variables inside the OrderController in <var>src/&lt;project_name&gt;/Yves/Customer/Controller/OrderController.php</var>:
</p><pre><code class="bash">&lt;?php
...
use Generated\Shared\Transfer\PayoneGetPaymentDetailTransfer;
...
class  OrderController extends AbstractCustomerController
{
    ...
    protected function getOrderDetailsResponseData($idSalesOrder)
    {
        ...
        $getPaymentDetailTransfer = new PayoneGetPaymentDetailTransfer();
        $getPaymentDetailTransfer-&gt;setOrderId($idSalesOrder);
        $getPaymentDetailTransfer = $this-&gt;getFactory()
            -&gt;getPayoneClient()-&gt;getPaymentDetail($getPaymentDetailTransfer);

        return [
            'order' =&gt; $orderTransfer,
            'paymentDetail' =&gt; $getPaymentDetailTransfer-&gt;getPaymentDetail(),
        ];
    }
</code></pre>
                                                    <p><strong>See also:</strong>
                                                    </p>
                                                    <ul>
                                                        <li class="bullet_list" value="1"><![CDATA[
                ]]><a href="../v1_0/payone-state-machine-cmd-cond-evnt.htm">State Machine Commands, Conditions and Events</a><![CDATA[
            ]]></li>
                                                        <li class="bullet_list" value="2"><![CDATA[
                ]]><a href="../v1_0/payone-facade.htm">Payone Facade</a><![CDATA[
            ]]></li>
                                                        <li class="bullet_list" value="3"><![CDATA[
                ]]><a href="../v1_0/payone-authorization-and-preauthorization-capture-flows.htm"><li class="bullet_list" value="1">Authorization and Preauthorization-Capture flows
            </li></a></li>
                                                        <li value="4"><a href="https://www.payone.com/en/company/press-news/press-releases/payone-and-spryker-have-agreed-on-a-strategic-partnership/" target="_blank">PAYONE and Spryker have agreed on a strategic partnership</a>
                                                        </li>
                                                        <li value="5"><a href="https://www.payone.com/en/platform-integration/extensions/spryker/" target="_blank">BS PAYONE payment for Spryker </a><![CDATA[           ]]></li>
                                                    </ul>
                                                    <p>&#160;</p>
                                                    <p><i>Last review date: Jul. 6th, 2018 </i>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div><a class="scroll-top js-scroll-top" href="#"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill="#FFF" fill-rule="nonzero" d="M11.82 5.22a.54.54 0 0 1 0 .806.636.636 0 0 1-.852 0L6.607 1.937v13.49a.587.587 0 0 1-.602.573c-.336 0-.611-.258-.611-.573V1.937L1.04 6.026a.647.647 0 0 1-.86 0 .54.54 0 0 1 0-.807L5.573.163a.636.636 0 0 1 .852 0L11.82 5.22z" /></svg></a>
                                <script>/* <![CDATA[ */
			function createGithubUrl() {
			var GITHUB_CONTENT_PATH = '/blob/master/public';
			var link = document.querySelector('.js-widget-github-link');
			var href =
			link.getAttribute('href')
			+ GITHUB_CONTENT_PATH
			+ window.location.pathname;
			link.setAttribute('href', href);
			}
			createGithubUrl();
		/* ]]> */</script>
                                <script>/* <![CDATA[ */
			requirejs.config({
				appDir: '',
				paths: {
					'clipboard': ['https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min']
					
				}
			});
			require(['clipboard'], function(Clipboard) {
				console.log(Clipboard);
				window.Clipboard = Clipboard;
			});
		/* ]]> */</script>
                                <script src="../../../../resources/scripts/perfect-scrollbar.js">
                                </script>
                                <script src="../../../../resources/scripts/script.js">
                                </script>
                                <script src="../../../../resources/scripts/prism.js">
                                </script>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>